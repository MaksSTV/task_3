let addCommentBtn = document.querySelector(".btn__submit");
let addCommentEnter = document.querySelector(".addComment__form");
let name = document.querySelector(".nameComment");
let date = document.querySelector(".dateComment");
let comment = document.querySelector(".textComment");
let commList = document.querySelector(".comment-list");
let alertMess = document.querySelector('.hidden-alert');

addCommentBtn.addEventListener('click', function(event){
    event.preventDefault();
    addComment();
})

addCommentEnter.addEventListener('keydown', function(event){
    alertMess.style.opacity = 0;
    if (event.keyCode === 13) {
        addComment();
    }
})

commList.addEventListener("click", function(event){
    let svg = event.target.closest('span');

    if(!svg) return;

    if(svg.classList.contains('span__like')){
        if(svg.classList.contains('red')){
            svg.childNodes[1].childNodes[1].style.fill = "#ACACAC";
            svg.classList.remove("red")
        }
        else{
            svg.classList.add("red");
            svg.childNodes[1].childNodes[1].style.fill = "#C63838";
        }        
    }
    if(svg.className == 'span__rubbish'){
        let del = svg.parentNode.parentNode.parentNode;
        del.remove();
    }
})

function addComment(){
    if(name.value == '' || comment.value == ''){
        alertMess.style.opacity = 1;
        return;
    }
    else{
        let dateString;
        let time = new Date();
        if(date.value == ''){
            dateString = 'сегодня';
        }
        else{
            let setTime = date.valueAsDate.getDate();
            time.setDate(time.getDate()-1);
            if(setTime - time.getDate() == 1){
                dateString = 'сегодня';
            }
            else if(setTime - time.getDate() == 0){
                dateString = 'вчера';
            }
            else{
                dateString = date.value;
            }
        }
        
        
        
        let hours = time.getHours();
        let minutes = time.getMinutes();
        
        dateString += ` ${hours}:${minutes}`;
        alertMess.style.opacity = 0;
        let tempComm = document.createElement('div');
        tempComm.className = 'comment';
        tempComm.innerHTML = `<div class="comment__avatar">
        <svg class="avatar"
          width="52"
          height="52"
          viewBox="0 0 26 26"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M13 26C10.4288 26 7.91542 25.2376 5.77759 23.8091C3.63975 22.3806 1.9735 20.3503 0.989564 17.9749C0.00562507 15.5994 -0.251818 12.9856 0.24979 10.4638C0.751397 7.94207 1.98953 5.62569 3.80761 3.80761C5.62569 1.98953 7.94207 0.751399 10.4638 0.249792C12.9856 -0.251816 15.5994 0.00562698 17.9749 0.989566C20.3503 1.97351 22.3806 3.63975 23.8091 5.77759C25.2376 7.91543 26 10.4288 26 13C26 16.4478 24.6304 19.7544 22.1924 22.1924C19.7544 24.6304 16.4478 26 13 26ZM13 2C10.8244 2 8.69767 2.64514 6.88873 3.85383C5.07978 5.06253 3.66989 6.7805 2.83732 8.79048C2.00476 10.8005 1.78692 13.0122 2.21136 15.146C2.6358 17.2798 3.68345 19.2398 5.22182 20.7782C6.7602 22.3166 8.72021 23.3642 10.854 23.7886C12.9878 24.2131 15.1995 23.9952 17.2095 23.1627C19.2195 22.3301 20.9375 20.9202 22.1462 19.1113C23.3549 17.3023 24 15.1756 24 13C24 10.0826 22.8411 7.28473 20.7782 5.22183C18.7153 3.15893 15.9174 2 13 2Z"
            fill="#AEAEAE"
          />
          <path
            d="M13 14C12.0111 14 11.0444 13.7068 10.2221 13.1573C9.3999 12.6079 8.75904 11.827 8.3806 10.9134C8.00216 9.99979 7.90314 8.99445 8.09607 8.02455C8.28899 7.05464 8.7652 6.16373 9.46446 5.46447C10.1637 4.7652 11.0546 4.289 12.0245 4.09607C12.9944 3.90315 13.9998 4.00216 14.9134 4.3806C15.827 4.75904 16.6079 5.3999 17.1573 6.22215C17.7068 7.04439 18 8.01109 18 9C18 10.3261 17.4732 11.5979 16.5355 12.5355C15.5978 13.4732 14.3261 14 13 14ZM13 6C12.4067 6 11.8266 6.17595 11.3333 6.50559C10.8399 6.83524 10.4554 7.30377 10.2284 7.85195C10.0013 8.40013 9.94188 9.00333 10.0576 9.58527C10.1734 10.1672 10.4591 10.7018 10.8787 11.1213C11.2982 11.5409 11.8328 11.8266 12.4147 11.9424C12.9967 12.0581 13.5999 11.9987 14.148 11.7716C14.6962 11.5446 15.1648 11.1601 15.4944 10.6667C15.824 10.1734 16 9.59334 16 9C16 8.20435 15.6839 7.44129 15.1213 6.87868C14.5587 6.31607 13.7956 6 13 6Z"
            fill="#AEAEAE"
          />
          <path
            d="M22.55 21C22.4112 21.0009 22.2737 20.973 22.1463 20.9179C22.0189 20.8628 21.9044 20.7818 21.81 20.68C20.7486 19.5222 19.4584 18.5974 18.0211 17.9639C16.5838 17.3305 15.0307 17.0022 13.46 17H12.54C9.6122 16.9937 6.79687 18.127 4.69 20.16C4.49534 20.3206 4.24714 20.4017 3.99519 20.387C3.74324 20.3723 3.50618 20.2628 3.33156 20.0806C3.15693 19.8984 3.05767 19.6569 3.05367 19.4045C3.04967 19.1522 3.14124 18.9077 3.31 18.72C5.78588 16.3269 9.09665 14.9926 12.54 15H13.46C15.3062 15.0042 17.1316 15.3901 18.8216 16.1335C20.5115 16.877 22.0294 17.9618 23.28 19.32C23.4121 19.4625 23.4999 19.6403 23.5326 19.8319C23.5652 20.0234 23.5414 20.2203 23.4639 20.3985C23.3865 20.5767 23.2588 20.7285 23.0965 20.8353C22.9342 20.9422 22.7443 20.9994 22.55 21Z"
            fill="#AEAEAE"
          />
        </svg>
      </div>
      <div class="comment__content">
        <div class="name">${name.value}</div>
        <div class="time">${dateString}</div>
        <div class="comment">
        ${comment.value}
        </div>
        <div class="like-rubbish">
                      <span class="span__like">
                        <svg
                          class="like"
                          width="24"
                          height="28"
                          viewBox="0 0 32 28"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M14.708 13.847C14.252 12.864 14 11.742 14 10.5C14 9.258 14.252 8.011 14.708 6.841C15.163 5.67 15.822 4.575 16.637 3.636C17.451 2.698 18.421 1.913 19.497 1.365C20.574 0.814 21.758 0.5 23 0.5C24.242 0.5 25.426 0.752 26.503 1.207C27.58 1.663 28.549 2.322 29.363 3.136C30.176 3.95 30.837 4.92 31.292 5.997C31.749 7.073 32 8.258 32 9.5C32 10.742 31.748 11.927 31.292 13.003C30.837 14.08 30.178 15.05 29.363 15.864C28.55 16.678 17.077 27.044 16 27.5C14.923 27.044 3.45 16.678 2.636 15.864C1.822 15.05 1.163 14.08 0.707 13.003C0.252 11.927 0 10.742 0 9.5C0 8.258 0.252 7.073 0.707 5.997C1.163 4.92 1.821 3.95 2.636 3.136C3.45 2.322 4.42 1.663 5.497 1.207C6.573 0.752 7.757 0.5 9 0.5C10.243 0.5 11.427 0.814 12.503 1.363C13.58 1.913 14.549 2.697 15.364 3.635C16.178 4.574 16.837 5.669 17.293 6.84C17.748 8.011 18 9.258 18 10.5C18 11.742 17.748 12.864 17.293 13.847C16.837 14.83 16.18 15.675 15.364 16.365"
                            fill="#ACACAC"
                          />
                          <!-- fill="#C63838"-->
                        </svg></span
                      >
                      <span class="span__rubbish">
                        <svg
                          class="rubbish"
                          width="18"
                          height="30"
                          viewBox="0 0 26 30"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M21 30H5C4.20435 30 3.44129 29.6839 2.87868 29.1213C2.31607 28.5587 2 27.7956 2 27V8C2 7.73478 2.10536 7.48043 2.29289 7.29289C2.48043 7.10536 2.73478 7 3 7C3.26522 7 3.51957 7.10536 3.70711 7.29289C3.89464 7.48043 4 7.73478 4 8V27C4 27.2652 4.10536 27.5196 4.29289 27.7071C4.48043 27.8946 4.73478 28 5 28H21C21.2652 28 21.5196 27.8946 21.7071 27.7071C21.8946 27.5196 22 27.2652 22 27V8C22 7.73478 22.1054 7.48043 22.2929 7.29289C22.4804 7.10536 22.7348 7 23 7C23.2652 7 23.5196 7.10536 23.7071 7.29289C23.8946 7.48043 24 7.73478 24 8V27C24 27.7956 23.6839 28.5587 23.1213 29.1213C22.5587 29.6839 21.7956 30 21 30Z"
                            fill="#ACACAC"
                          />
                          <path
                            d="M25 6H1C0.734784 6 0.48043 5.89464 0.292893 5.70711C0.105357 5.51957 0 5.26522 0 5C0 4.73478 0.105357 4.48043 0.292893 4.29289C0.48043 4.10536 0.734784 4 1 4H25C25.2652 4 25.5196 4.10536 25.7071 4.29289C25.8946 4.48043 26 4.73478 26 5C26 5.26522 25.8946 5.51957 25.7071 5.70711C25.5196 5.89464 25.2652 6 25 6Z"
                            fill="#ACACAC"
                          />
                          <path
                            d="M17 6C16.7348 6 16.4804 5.89464 16.2929 5.70711C16.1054 5.51957 16 5.26522 16 5V2H10V5C10 5.26522 9.89464 5.51957 9.70711 5.70711C9.51957 5.89464 9.26522 6 9 6C8.73478 6 8.48043 5.89464 8.29289 5.70711C8.10536 5.51957 8 5.26522 8 5V1C8 0.734784 8.10536 0.48043 8.29289 0.292893C8.48043 0.105357 8.73478 0 9 0H17C17.2652 0 17.5196 0.105357 17.7071 0.292893C17.8946 0.48043 18 0.734784 18 1V5C18 5.26522 17.8946 5.51957 17.7071 5.70711C17.5196 5.89464 17.2652 6 17 6Z"
                            fill="#ACACAC"
                          />
                          <path
                            d="M13 25C12.7348 25 12.4804 24.8946 12.2929 24.7071C12.1054 24.5196 12 24.2652 12 24V10C12 9.73478 12.1054 9.48043 12.2929 9.29289C12.4804 9.10536 12.7348 9 13 9C13.2652 9 13.5196 9.10536 13.7071 9.29289C13.8946 9.48043 14 9.73478 14 10V24C14 24.2652 13.8946 24.5196 13.7071 24.7071C13.5196 24.8946 13.2652 25 13 25Z"
                            fill="#ACACAC"
                          />
                          <path
                            d="M18 23C17.7348 23 17.4804 22.8946 17.2929 22.7071C17.1054 22.5196 17 22.2652 17 22V12C17 11.7348 17.1054 11.4804 17.2929 11.2929C17.4804 11.1054 17.7348 11 18 11C18.2652 11 18.5196 11.1054 18.7071 11.2929C18.8946 11.4804 19 11.7348 19 12V22C19 22.2652 18.8946 22.5196 18.7071 22.7071C18.5196 22.8946 18.2652 23 18 23Z"
                            fill="#ACACAC"
                          />
                          <path
                            d="M8 23C7.73478 23 7.48043 22.8946 7.29289 22.7071C7.10536 22.5196 7 22.2652 7 22V12C7 11.7348 7.10536 11.4804 7.29289 11.2929C7.48043 11.1054 7.73478 11 8 11C8.26522 11 8.51957 11.1054 8.70711 11.2929C8.89464 11.4804 9 11.7348 9 12V22C9 22.2652 8.89464 22.5196 8.70711 22.7071C8.51957 22.8946 8.26522 23 8 23Z"
                            fill="#ACACAC"
                          />
                          </svg>
                    </span>
                    </div>`
    
        commList.append(tempComm);
    
        name.value = null;
        date.value = null;
        comment.value = null;
    }
}